{% extends "base.html" %}

{% block title %}Pricing - PDF Toolkit{% endblock %}

{% block content %}
<div class="pricing-page">
    <div class="container">
        <div class="pricing-header">
            <h1>Simple, Transparent Pricing</h1>
            <p>Choose the plan that works for you</p>
        </div>

        <div class="pricing-grid">
            <div class="pricing-card">
                <div class="plan-name">Free</div>
                <div class="plan-price">
                    <span class="currency">$</span>
                    <span class="amount">0</span>
                    <span class="period">/month</span>
                </div>
                <ul class="plan-features">
                    <li>✓ 5 operations per month</li>
                    <li>✓ All PDF tools</li>
                    <li>✓ Max 10MB file size</li>
                    <li>✓ No credit card required</li>
                </ul>
                <a href="{{ url_for('register') }}" class="btn btn-secondary btn-block">Get Started</a>
            </div>

            <div class="pricing-card featured">
                <div class="popular-badge">Most Popular</div>
                <div class="plan-name">Basic</div>
                <div class="plan-price">
                    <span class="currency">$</span>
                    <span class="amount">9</span>
                    <span class="period">/month</span>
                </div>
                <ul class="plan-features">
                    <li>✓ 100 operations per month</li>
                    <li>✓ All PDF tools</li>
                    <li>✓ Max 50MB file size</li>
                    <li>✓ Priority support</li>
                    <li>✓ No watermarks</li>
                </ul>
                {% if current_user.is_authenticated %}
                    <button class="btn btn-primary btn-block" onclick="subscribe('{{ config.STRIPE_PRICE_BASIC }}')">
                        Subscribe Now
                    </button>
                {% else %}
                    <a href="{{ url_for('register') }}" class="btn btn-primary btn-block">Get Started</a>
                {% endif %}
            </div>

            <div class="pricing-card">
                <div class="plan-name">Pro</div>
                <div class="plan-price">
                    <span class="currency">$</span>
                    <span class="amount">29</span>
                    <span class="period">/month</span>
                </div>
                <ul class="plan-features">
                    <li>✓ 1000 operations per month</li>
                    <li>✓ All PDF tools</li>
                    <li>✓ Max 100MB file size</li>
                    <li>✓ Priority support</li>
                    <li>✓ API access</li>
                    <li>✓ Batch processing</li>
                </ul>
                {% if current_user.is_authenticated %}
                    <button class="btn btn-primary btn-block" onclick="subscribe('{{ config.STRIPE_PRICE_PRO }}')">
                        Subscribe Now
                    </button>
                {% else %}
                    <a href="{{ url_for('register') }}" class="btn btn-primary btn-block">Get Started</a>
                {% endif %}
            </div>
        </div>

        <div class="pricing-faq">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-item">
                <h3>Can I cancel anytime?</h3>
                <p>Yes! You can cancel your subscription at any time. No questions asked.</p>
            </div>
            <div class="faq-item">
                <h3>What payment methods do you accept?</h3>
                <p>We accept all major credit cards through Stripe.</p>
            </div>
            <div class="faq-item">
                <h3>Is my data secure?</h3>
                <p>Absolutely. All files are processed securely and deleted immediately after processing.</p>
            </div>
        </div>
    </div>
</div>

{% if current_user.is_authenticated %}
<script src="https://js.stripe.com/v3/"></script>
<script>
async function subscribe(priceId) {
    try {
        const response = await fetch('{{ url_for("create_checkout_session") }}', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ price_id: priceId })
        });

        const data = await response.json();

        if (data.checkout_url) {
            window.location.href = data.checkout_url;
        } else {
            alert('Error creating checkout session');
        }
    } catch (error) {
        alert('Error: ' + error.message);
    }
}
</script>
{% endif %}
{% endblock %}
